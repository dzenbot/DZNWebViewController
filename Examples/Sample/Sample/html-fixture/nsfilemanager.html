<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>
      NSFileManager : NSHipster
    </title>
    <meta name="description" content=
    "NSHipster is a journal of the overlooked bits in Objective-C and Cocoa. Updated weekly.">
    <meta name="author" content="Mattt Thompson">
    <meta name="revisit-after" content="3 days">
    <meta name="viewport" content="width=device-width">
    <link rel="license" href=
    "http://creativecommons.org/licenses/by-nc/3.0/">
    <link rel="alternate" hreflang="en-us" href=
    "http://nshipster.com">
    <link rel="alternate" hreflang="zh-Hans" href=
    "http://nshipster.cn">
    <link rel="alternate" hreflang="x-default" href=
    "http://nshipster.com">
    <link rel="alternate" type="application/rss+xml" title="RSS"
    href="http://nshipster.com/feed.xml">
    <link rel="stylesheet" href="/css/screen.css" type="text/css">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@NSHipster">
    <meta name="twitter:creator" content="@mattt">
    <meta name="twitter:title" content="NSFileManager">
    <meta name="twitter:description" content=
    "File systems are a complex topic, with decades of history, vestigial complexities, and idiosyncrasies, and is well outside the scope of a single article. And since most applications don't often interact with the file system much beyond simple file operations, one can get away with only knowing the basics.">
    <meta content="NSHipster" property="og:site_name">
    <meta content="NSFileManager" property="og:title">
    <meta content="http://nshipster.com/nsfilemanager/" property=
    "og:url">
    <meta content=
    "File systems are a complex topic, with decades of history, vestigial complexities, and idiosyncrasies, and is well outside the scope of a single article. And since most applications don't often interact with the file system much beyond simple file operations, one can get away with only knowing the basics."
    property="og:description">
    <meta property="st:title" content="NSFileManager">
    <meta property="st:type" content="article">
    <script type="text/javascript">
var _sf_startpt=(new Date()).getTime()
    </script>
    <script onload="try{Typekit.load();}catch(e){}" src=
    "//use.typekit.net/agk0bgp.js" type="text/javascript">
</script>
  </head>
  <body>
    <div role="container">
      <header role="banner">
        <h1 id="logo">
          <a href="/"><acronym title="NeXTSTEP/Sun">NS</acronym>
          <strong>Hipster</strong> <img id="moustache" src=
          "//cdn.nshipster.com/images/moustache.svg" width="200"
          height="150" data-author=
          "http://thenounproject.com/bnhw"></a>
        </h1>
        <form>
          <input type="text" id="st-search-input" class=
          "st-search-input">
        </form>
      </header>
      <div id="main" role="main">
        <article>
          <header>
            <h1>
              <a href="/nsfilemanager/">NSFile​Manager</a>
            </h1>
            <h2>
              Written by <a href="http://mattt.me/">Mattt
              Thompson</a> on <time pubdate=
              "2013-11-18 00:00:00 -0800">Nov 18<span>th</span>,
              2013</time>
            </h2>
          </header>
          <div class="content" data-swiftype-index="true">
            <p>
              <code>NSFileManager</code> is Foundation's high-level
              API for working with file systems. It abstracts Unix
              and Finder internals, providing a convenient way to
              create, read, move, copy, and delete files &amp;
              directories on local or networked drives, as well as
              iCloud ubiquitous containers.
            </p>
            <p>
              File systems are a complex topic, with decades of
              history, vestigial complexities, and idiosyncrasies,
              and is well outside the scope of a single article.
              And since most applications don't often interact with
              the file system much beyond simple file operations,
              one can get away with only knowing the basics.
            </p>
            <p>
              What follows are some code samples for your
              copy-pasting pleasure. Use them as a foundation for
              understanding how to adjust parameters to your
              particular use case:
            </p>
            <h2>
              Common Tasks
            </h2>
            <blockquote>
              <p>
                Throughout the code samples is the magical
                incantation
                <code>NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                NSUserDomainMask, YES)</code>. This may be tied
                with KVO as one of the worst APIs in Cocoa. Just
                know that this returns an array containing the user
                documents directory as the first object. Thank
                goodness for the inclusion of <code>NSArray
                -firstObject</code>.
              </p>
            </blockquote>
            <h3>
              Determining If A File Exists
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSFileManager</span> <span class=
"n">defaultManager</span><span class="p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">documentsPath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSSearchPathForDirectoriesInDomains</span><span class=
"p">(</span><span class="n">NSDocumentDirectory</span><span class=
"p">,</span> <span class="n">NSUserDomainMask</span><span class=
"p">,</span> <span class="nb">YES</span><span class=
"p">)</span> <span class="n">firstObject</span><span class=
"p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">filePath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">documentsPath</span> <span class=
"n">stringByAppendingPathComponent</span><span class=
"o">:</span><span class="s">@"file.txt"</span><span class=
"p">];</span>
<span class="kt">BOOL</span> <span class=
"n">fileExists</span> <span class="o">=</span> <span class=
"p">[</span><span class="n">fileManager</span> <span class=
"n">fileExistsAtPath</span><span class="o">:</span><span class=
"n">filePath</span><span class="p">];</span>
</code>
</pre>
            </div>
            <h3>
              Listing All Files In A Directory
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSFileManager</span> <span class=
"n">defaultManager</span><span class="p">];</span>
<span class="n">NSURL</span> <span class="o">*</span><span class=
"n">bundleURL</span> <span class="o">=</span> <span class=
"p">[[</span><span class="n">NSBundle</span> <span class=
"n">mainBundle</span><span class="p">]</span> <span class=
"n">bundleURL</span><span class="p">];</span>
<span class="n">NSArray</span> <span class="o">*</span><span class=
"n">contents</span> <span class="o">=</span> <span class=
"p">[</span><span class="n">fileManager</span> <span class=
"n">contentsOfDirectoryAtURL</span><span class=
"o">:</span><span class="n">bundleURL</span>
                               <span class=
"nl">includingPropertiesForKeys:</span><span class="p">@[]</span>
                                                  <span class=
"nl">options:</span><span class=
"n">NSDirectoryEnumerationSkipsHiddenFiles</span>
                                                    <span class=
"nl">error:</span><span class="nb">nil</span><span class=
"p">];</span>

<span class="n">NSPredicate</span> <span class=
"o">*</span><span class="n">predicate</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSPredicate</span> <span class=
"n">predicateWithFormat</span><span class="o">:</span><span class=
"s">@"pathExtension == 'png'"</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class=
"n">NSURL</span> <span class="o">*</span><span class=
"n">fileURL</span> <span class="k">in</span> <span class=
"p">[</span><span class="n">contents</span> <span class=
"n">filteredArrayUsingPredicate</span><span class=
"o">:</span><span class="n">predicate</span><span class=
"p">])</span> <span class="p">{</span>
    <span class=
"c1">// Enumerate each .png file in directory</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h2>
              Recursively Enumerating Files In A Directory
            </h2>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSFileManager</span> <span class=
"n">defaultManager</span><span class="p">];</span>
<span class="n">NSURL</span> <span class="o">*</span><span class=
"n">bundleURL</span> <span class="o">=</span> <span class=
"p">[[</span><span class="n">NSBundle</span> <span class=
"n">mainBundle</span><span class="p">]</span> <span class=
"n">bundleURL</span><span class="p">];</span>
<span class="n">NSDirectoryEnumerator</span> <span class=
"o">*</span><span class="n">enumerator</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">fileManager</span> <span class=
"n">enumeratorAtURL</span><span class="o">:</span><span class=
"n">bundleURL</span>
                                      <span class=
"nl">includingPropertiesForKeys:</span><span class=
"p">@[</span><span class="n">NSURLNameKey</span><span class=
"p">,</span> <span class="n">NSURLIsDirectoryKey</span><span class=
"p">]</span>
                                                         <span class="nl">options:</span><span class="n">NSDirectoryEnumerationSkipsHiddenFiles</span>
                                                    <span class=
"nl">errorHandler:</span><span class="o">^</span><span class=
"kt">BOOL</span><span class="p">(</span><span class=
"n">NSURL</span> <span class="o">*</span><span class=
"n">url</span><span class="p">,</span> <span class=
"n">NSError</span> <span class="o">*</span><span class=
"n">error</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">NSLog</span><span class=
"p">(</span><span class="s">@"[Error] %@ (%@)"</span><span class=
"p">,</span> <span class="n">error</span><span class=
"p">,</span> <span class="n">url</span><span class="p">);</span>
<span class="p">}];</span>

<span class="n">NSMutableArray</span> <span class=
"o">*</span><span class="n">mutableFileURLs</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSMutableArray</span> <span class="n">array</span><span class=
"p">];</span>
<span class="k">for</span> <span class="p">(</span><span class=
"n">NSURL</span> <span class="o">*</span><span class=
"n">fileURL</span> <span class="k">in</span> <span class=
"n">enumerator</span><span class="p">)</span> <span class=
"p">{</span>
    <span class="n">NSString</span> <span class=
"o">*</span><span class="n">filename</span><span class="p">;</span>
    <span class="p">[</span><span class=
"n">fileURL</span> <span class=
"n">getResourceValue</span><span class=
"o">:&amp;</span><span class="n">filename</span> <span class=
"n">forKey</span><span class="o">:</span><span class=
"n">NSURLNameKey</span> <span class="n">error</span><span class=
"o">:</span><span class="nb">nil</span><span class="p">];</span>

    <span class="n">NSNumber</span> <span class=
"o">*</span><span class="n">isDirectory</span><span class=
"p">;</span>
    <span class="p">[</span><span class=
"n">fileURL</span> <span class=
"n">getResourceValue</span><span class=
"o">:&amp;</span><span class="n">isDirectory</span> <span class=
"n">forKey</span><span class="o">:</span><span class=
"n">NSURLIsDirectoryKey</span> <span class=
"n">error</span><span class="o">:</span><span class=
"nb">nil</span><span class="p">];</span>

    <span class=
"c1">// Skip directories with '_' prefix, for example</span>
    <span class="k">if</span> <span class="p">([</span><span class=
"n">filename</span> <span class="n">hasPrefix</span><span class=
"o">:</span><span class="s">@"_"</span><span class=
"p">]</span> <span class="o">&amp;&amp;</span> <span class=
"p">[</span><span class="n">isDirectory</span> <span class=
"n">boolValue</span><span class="p">])</span> <span class=
"p">{</span>
        <span class="p">[</span><span class=
"n">enumerator</span> <span class=
"n">skipDescendants</span><span class="p">];</span>
        <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class=
"o">!</span><span class="p">[</span><span class=
"n">isDirectory</span> <span class="n">boolValue</span><span class=
"p">])</span> <span class="p">{</span>
        <span class="p">[</span><span class=
"n">mutableFileURLs</span> <span class=
"n">addObject</span><span class="o">:</span><span class=
"n">fileURL</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h3>
              Creating a Directory
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSFileManager</span> <span class=
"n">defaultManager</span><span class="p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">documentsPath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSSearchPathForDirectoriesInDomains</span><span class=
"p">(</span><span class="n">NSDocumentDirectory</span><span class=
"p">,</span> <span class="n">NSUserDomainMask</span><span class=
"p">,</span> <span class="nb">YES</span><span class=
"p">)</span> <span class="n">firstObject</span><span class=
"p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">imagesPath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">documentsPath</span> <span class=
"n">stringByAppendingPathComponent</span><span class=
"o">:</span><span class="s">@"images"</span><span class=
"p">];</span>
<span class="k">if</span> <span class="p">(</span><span class=
"o">!</span><span class="p">[</span><span class=
"n">fileManager</span> <span class=
"n">fileExistsAtPath</span><span class="o">:</span><span class=
"n">imagesPath</span><span class="p">])</span> <span class=
"p">{</span>
    <span class="p">[</span><span class=
"n">fileManager</span> <span class=
"n">createDirectoryAtPath</span><span class=
"o">:</span><span class="n">imagesPath</span> <span class=
"n">withIntermediateDirectories</span><span class=
"o">:</span><span class="nb">NO</span> <span class=
"n">attributes</span><span class="o">:</span><span class=
"nb">nil</span> <span class="n">error</span><span class=
"o">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h3>
              Deleting a File
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSFileManager</span> <span class=
"n">defaultManager</span><span class="p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">documentsPath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSSearchPathForDirectoriesInDomains</span><span class=
"p">(</span><span class="n">NSDocumentDirectory</span><span class=
"p">,</span> <span class="n">NSUserDomainMask</span><span class=
"p">,</span> <span class="nb">YES</span><span class=
"p">)</span> <span class="n">firstObject</span><span class=
"p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">filePath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">documentsPath</span> <span class=
"n">stringByAppendingPathComponent</span><span class=
"o">:</span><span class="s">@"image.png"</span><span class=
"p">];</span>
<span class="n">NSError</span> <span class="o">*</span><span class=
"n">error</span> <span class="o">=</span> <span class=
"nb">nil</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class=
"o">!</span><span class="p">[</span><span class=
"n">fileManager</span> <span class=
"n">removeItemAtPath</span><span class="o">:</span><span class=
"n">filePath</span> <span class="n">error</span><span class=
"o">:&amp;</span><span class="n">error</span><span class=
"p">])</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class=
"p">(</span><span class="s">@"[Error] %@ (%@)"</span><span class=
"p">,</span> <span class="n">error</span><span class=
"p">,</span> <span class="n">filePath</span><span class=
"p">);</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h3>
              Determining the Creation Date of a File
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSFileManager</span> <span class=
"n">defaultManager</span><span class="p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">documentsPath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSSearchPathForDirectoriesInDomains</span><span class=
"p">(</span><span class="n">NSDocumentDirectory</span><span class=
"p">,</span> <span class="n">NSUserDomainMask</span><span class=
"p">,</span> <span class="nb">YES</span><span class=
"p">)</span> <span class="n">firstObject</span><span class=
"p">];</span>
<span class="n">NSString</span> <span class=
"o">*</span><span class="n">filePath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">documentsPath</span> <span class=
"n">stringByAppendingPathComponent</span><span class=
"o">:</span><span class="s">@"Document.pages"</span><span class=
"p">];</span>

<span class="n">NSDate</span> <span class="o">*</span><span class=
"n">creationDate</span> <span class="o">=</span> <span class=
"nb">nil</span><span class="p">;</span>
<span class="k">if</span> <span class="p">([</span><span class=
"n">fileManager</span> <span class=
"n">fileExistsAtPath</span><span class="o">:</span><span class=
"n">filePath</span><span class="p">])</span> <span class=
"p">{</span>
    <span class="n">NSDictionary</span> <span class=
"o">*</span><span class="n">attributes</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">fileManager</span> <span class=
"n">attributesOfItemAtPath</span><span class=
"o">:</span><span class="n">filePath</span> <span class=
"n">error</span><span class="o">:</span><span class=
"nb">nil</span><span class="p">];</span>
    <span class="n">creationDate</span> <span class=
"o">=</span> <span class="n">attributes</span><span class=
"p">[</span><span class="n">NSFileCreationDate</span><span class=
"p">];</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <p>
              There are a number of file attributes that are made
              accessible through <code>NSFileManager</code>, which
              can be fetched with
              <code>-attributesOfItemAtPath:error:</code>, and
              other methods:
            </p>
            <h4>
              File Attribute Keys
            </h4>
            <blockquote>
              <ul>
                <li>
                  <code>NSFileAppendOnly</code>: The key in a file
                  attribute dictionary whose value indicates
                  whether the file is read-only.
                </li>
                <li>
                  <code>NSFileBusy</code>: The key in a file
                  attribute dictionary whose value indicates
                  whether the file is busy.
                </li>
                <li>
                  <code>NSFileCreationDate</code>: The key in a
                  file attribute dictionary whose value indicates
                  the file's creation date.
                </li>
                <li>
                  <code>NSFileOwnerAccountName</code>: The key in a
                  file attribute dictionary whose value indicates
                  the name of the file's owner.
                </li>
                <li>
                  <code>NSFileGroupOwnerAccountName</code>: The key
                  in a file attribute dictionary whose value
                  indicates the group name of the file's owner.
                </li>
                <li>
                  <code>NSFileDeviceIdentifier</code>: The key in a
                  file attribute dictionary whose value indicates
                  the identifier for the device on which the file
                  resides.
                </li>
                <li>
                  <code>NSFileExtensionHidden</code>: The key in a
                  file attribute dictionary whose value indicates
                  whether the file's extension is hidden.
                </li>
                <li>
                  <code>NSFileGroupOwnerAccountID</code>: The key
                  in a file attribute dictionary whose value
                  indicates the file's group ID.
                </li>
                <li>
                  <code>NSFileHFSCreatorCode</code>: The key in a
                  file attribute dictionary whose value indicates
                  the file's HFS creator code.
                </li>
                <li>
                  <code>NSFileHFSTypeCode</code>: The key in a file
                  attribute dictionary whose value indicates the
                  file's HFS type code.
                </li>
                <li>
                  <code>NSFileImmutable</code>: The key in a file
                  attribute dictionary whose value indicates
                  whether the file is mutable.
                </li>
                <li>
                  <code>NSFileModificationDate</code>: The key in a
                  file attribute dictionary whose value indicates
                  the file's last modified date.
                </li>
                <li>
                  <code>NSFileOwnerAccountID</code>: The key in a
                  file attribute dictionary whose value indicates
                  the file's owner's account ID.
                </li>
                <li>
                  <code>NSFilePosixPermissions</code>: The key in a
                  file attribute dictionary whose value indicates
                  the file's Posix permissions.
                </li>
                <li>
                  <code>NSFileReferenceCount</code>: The key in a
                  file attribute dictionary whose value indicates
                  the file's reference count.
                </li>
                <li>
                  <code>NSFileSize</code>: The key in a file
                  attribute dictionary whose value indicates the
                  file's size in bytes.
                </li>
                <li>
                  <code>NSFileSystemFileNumber</code>: The key in a
                  file attribute dictionary whose value indicates
                  the file's filesystem file number.
                </li>
                <li>
                  <p>
                    <code>NSFileType</code>: The key in a file
                    attribute dictionary whose value indicates the
                    file's type.
                  </p>
                </li>
                <li>
                  <p>
                    <code>NSDirectoryEnumerationSkipsSubdirectoryDescendants</code>:
                    Perform a shallow enumeration; do not descend
                    into directories.
                  </p>
                </li>
                <li>
                  <p>
                    <code>NSDirectoryEnumerationSkipsPackageDescendants</code>:
                    Do not descend into packages.
                  </p>
                </li>
                <li>
                  <p>
                    <code>NSDirectoryEnumerationSkipsHiddenFiles</code>:
                    Do not enumerate hidden files.
                  </p>
                </li>
              </ul>
            </blockquote>
            <h2>
              NSFileManagerDelegate
            </h2>
            <p>
              <code>NSFileManager</code> may optionally set a
              delegate to verify that it should perform a
              particular file operation. This allows the business
              logic of, for instance, which files to protect from
              deletion, to be factored out of the controller.
            </p>
            <p>
              There are four kinds of methods in the
              <code>&lt;NSFileManagerDelegate&gt;</code> protocol,
              each with a variation for working with paths, as well
              as methods for error handling:
            </p>
            <ul>
              <li>
                <code>-fileManager:shouldMoveItemAtURL:toURL:</code>
              </li>
              <li>
                <code>-fileManager:shouldCopyItemAtURL:toURL:</code>
              </li>
              <li>
                <code>-fileManager:shouldRemoveItemAtURL:</code>
              </li>
              <li>
                <code>-fileManager:shouldLinkItemAtURL:toURL:</code>
              </li>
            </ul>
            <p>
              If you were wondering when you might <code>alloc
              init</code> your own <code>NSFileManager</code>
              rather than using the shared instance, this is it. As
              per the documentation:
            </p>
            <blockquote>
              <p>
                If you use a delegate to receive notifications
                about the status of move, copy, remove, and link
                operations, you should create a unique instance of
                the file manager object, assign your delegate to
                that object, and use that file manager to initiate
                your operations.
              </p>
            </blockquote>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[[</span><span class=
"n">NSFileManager</span> <span class="n">alloc</span><span class=
"p">]</span> <span class="n">init</span><span class="p">];</span>
<span class="n">fileManager</span><span class=
"p">.</span><span class="n">delegate</span> <span class=
"o">=</span> <span class="n">delegate</span><span class=
"p">;</span>

<span class="n">NSURL</span> <span class="o">*</span><span class=
"n">bundleURL</span> <span class="o">=</span> <span class=
"p">[[</span><span class="n">NSBundle</span> <span class=
"n">mainBundle</span><span class="p">]</span> <span class=
"n">bundleURL</span><span class="p">];</span>
<span class="n">NSArray</span> <span class="o">*</span><span class=
"n">contents</span> <span class="o">=</span> <span class=
"p">[</span><span class="n">fileManager</span> <span class=
"n">contentsOfDirectoryAtURL</span><span class=
"o">:</span><span class="n">bundleURL</span>
                               <span class=
"nl">includingPropertiesForKeys:</span><span class="p">@[]</span>
                                                  <span class=
"nl">options:</span><span class=
"n">NSDirectoryEnumerationSkipsHiddenFiles</span>
                                                    <span class=
"nl">error:</span><span class="nb">nil</span><span class=
"p">];</span>

<span class="k">for</span> <span class="p">(</span><span class=
"n">NSString</span> <span class="o">*</span><span class=
"n">filePath</span> <span class="k">in</span> <span class=
"n">contents</span><span class="p">)</span> <span class=
"p">{</span>
    <span class="p">[</span><span class=
"n">fileManager</span> <span class=
"n">removeItemAtPath</span><span class="o">:</span><span class=
"n">filePath</span> <span class="n">error</span><span class=
"o">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h4>
              CustomFileManagerDelegate.m
            </h4>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class=
"cp">#pragma mark - NSFileManagerDelegate</span>

<span class="k">-</span> <span class="p">(</span><span class=
"kt">BOOL</span><span class="p">)</span><span class=
"nf">fileManager:</span><span class="p">(</span><span class=
"n">NSFileManager</span> <span class="o">*</span><span class=
"p">)</span><span class="nv">fileManager</span>
<span class="nl">shouldRemoveItemAtURL:</span><span class=
"p">(</span><span class="n">NSURL</span> <span class=
"o">*</span><span class="p">)</span><span class="nv">URL</span>
<span class="p">{</span>
    <span class="k">return</span> <span class=
"o">!</span><span class="p">[[[</span><span class=
"n">URL</span> <span class="n">lastPathComponent</span><span class=
"p">]</span> <span class="n">pathExtension</span><span class=
"p">]</span> <span class="n">isEqualToString</span><span class=
"o">:</span><span class="s">@"pdf"</span><span class="p">];</span>
<span class="p">}</span>
</code>
</pre>
            </div>
            <h2>
              Ubiquitous Storage
            </h2>
            <p>
              Documents can also be moved to iCloud. If you guessed
              that this would be anything but straight forward,
              you'd be 100% correct.
            </p>
            <p>
              This is another occasion when you'd <code>alloc
              init</code> your own <code>NSFileManager</code>
              rather than using the shared instance. Because
              <code>URLForUbiquityContainerIdentifier:</code> and
              <code>setUbiquitous:itemAtURL:destinationURL:error:</code>
              are blocking calls, this entire operation needs to be
              dispatched to a background queue.
            </p>
            <h3>
              Moving an Item to Ubiquitous Storage
            </h3>
            <div class="highlight">
              <pre>
<code class="objective-c language-objective-c" data-lang=
"objective-c"><span class="n">dispatch_async</span><span class=
"p">(</span><span class=
"n">dispatch_get_global_queue</span><span class=
"p">(</span><span class=
"n">DISPATCH_QUEUE_PRIORITY_BACKGROUND</span><span class=
"p">,</span> <span class="mi">0</span><span class=
"p">),</span> <span class="o">^</span><span class="p">{</span>
    <span class="n">NSFileManager</span> <span class=
"o">*</span><span class="n">fileManager</span> <span class=
"o">=</span> <span class="p">[[</span><span class=
"n">NSFileManager</span> <span class="n">alloc</span><span class=
"p">]</span> <span class="n">init</span><span class="p">];</span>
    <span class="n">NSString</span> <span class=
"o">*</span><span class="n">documentsPath</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSSearchPathForDirectoriesInDomains</span><span class=
"p">(</span><span class="n">NSDocumentDirectory</span><span class=
"p">,</span> <span class="n">NSUserDomainMask</span><span class=
"p">,</span> <span class="nb">YES</span><span class=
"p">)</span> <span class="n">firstObject</span><span class=
"p">];</span>
    <span class="n">NSURL</span> <span class=
"o">*</span><span class="n">fileURL</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">NSURL</span> <span class="n">fileURLWithPath</span><span class=
"o">:</span><span class="p">[</span><span class=
"n">documentsPath</span> <span class=
"n">stringByAppendingPathComponent</span><span class=
"o">:</span><span class="s">@"Document.pages"</span><span class=
"p">]];</span>

    <span class=
"c1">// Defaults to first listed in entitlements when `nil`; should replace with real identifier</span>
    <span class="n">NSString</span> <span class=
"o">*</span><span class="n">identifier</span> <span class=
"o">=</span> <span class="nb">nil</span><span class="p">;</span>

    <span class="n">NSURL</span> <span class=
"o">*</span><span class=
"n">ubiquitousContainerURL</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">fileManager</span> <span class=
"n">URLForUbiquityContainerIdentifier</span><span class=
"o">:</span><span class="n">identifier</span><span class=
"p">];</span>
    <span class="n">NSURL</span> <span class=
"o">*</span><span class="n">ubiquitousFileURL</span> <span class=
"o">=</span> <span class="p">[</span><span class=
"n">ubiquitousContainerURL</span> <span class=
"n">URLByAppendingPathComponent</span><span class=
"o">:</span><span class="s">@"Document.pages"</span><span class=
"p">];</span>

    <span class="n">NSError</span> <span class=
"o">*</span><span class="n">error</span> <span class=
"o">=</span> <span class="nb">nil</span><span class="p">;</span>
    <span class="kt">BOOL</span> <span class=
"n">success</span> <span class="o">=</span> <span class=
"p">[</span><span class="n">fileManager</span> <span class=
"n">setUbiquitous</span><span class="o">:</span><span class=
"nb">YES</span>
                                    <span class=
"nl">itemAtURL:</span><span class="n">fileURL</span>
                               <span class=
"nl">destinationURL:</span><span class="n">ubiquitousFileURL</span>
                                        <span class=
"nl">error:</span><span class="o">&amp;</span><span class=
"n">error</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class=
"o">!</span><span class="n">success</span><span class=
"p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class=
"p">(</span><span class=
"s">@"[Error] %@ (%@) (%@)"</span><span class=
"p">,</span> <span class="n">error</span><span class=
"p">,</span> <span class="n">fileURL</span><span class=
"p">,</span> <span class="n">ubiquitousFileURL</span><span class=
"p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code>
</pre>
            </div>
            <blockquote>
              <p>
                You can find more information about ubiquitous
                document storage in Apple's "iCloud File
                Management" document.
              </p>
            </blockquote>
            <hr>
            <p>
              There's a lot to know about file systems, but as an
              app developer, it's mostly an academic exercise. Now
              don't get me wrong—academic exercises are great! But
              they don't ship code. <code>NSFileManager</code>
              allows you to ignore most of the subtlety of all of
              this and get things done.
            </p>
          </div>
          <aside>
            <a href="https://twitter.com/share" class=
            "twitter-share-button" data-url=
            "http://nshipster.com/nsfilemanager/" data-via=
            "NSHipster" data-size="large">Tweet</a> <script type=
            "text/javascript">
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
            </script>
          </aside>
          <footer id="book" class="promotion">
            <a href="https://gum.co/cfhipsterref"></a>
            <div id="cfhipsterref-cover"></div>
            <div>
              <hgroup>
                <h1>
                  <a href=
                  "https://gum.co/cfhipsterref">CFHipsterRef:
                  Low-Level Programming on<br>
                  iOS &amp; Mac OS X</a>
                </h1>
                <h2>
                  Available May 27th, 2014
                </h2>
              </hgroup>
              <p>
                Perfect for intermediate and expert developers
                wanting to take a deeper dive into advanced topics,
                <em>CFHipsterRef: Low-Level Programming on iOS
                &amp; Mac OS X</em> covers the core technologies
                powering Cocoa, Objective-C, and the operating
                system itself, including Core Bluetooth,
                Accelerate, and the Objective-C runtime.
              </p><button onclick=
              "javascript:window.location.href='https://gum.co/cfhipsterref'">Pre-Order
              Now</button>
            </div>
          </footer>
        </article>
      </div>
      <footer role="contentinfo">
        <section class="credits colophon">
          <p>
            Created by <a href="http://mattt.me">Mattt
            Thompson</a>, and released under a <a href=
            "http://creativecommons.org/licenses/by-nc/3.0/" rel=
            "license">Creative Commons BY-NC License</a>. <a href=
            "https://plus.google.com/106751358503565042647?rel=author"
            style="display: none;"></a>
          </p>
          <p>
            Articles also available in <a href=
            "http://nshipster.cn" hreflang="zh-Hans">中文</a>.
          </p>
        </section>
        <aside class="links">
          <a href="https://github.com/NSHipster/articles/issues"
          class="icon-github" title="Pull Requests Welcome"
          aria-hidden="true"></a> <a href="/feed.xml" class=
          "icon-feed" title="RSS" aria-hidden="true"></a>
        </aside>
        <section class="archive" role="navigation">
          <div>
            <h2>
              Foundation
            </h2>
            <ul>
              <li>
                <a href="/nsurl/">NSURL /<br>
                NSURLComponents</a>
              </li>
              <li>
                <a href=
                "/nstemporarydirectory/">NSTemporaryDirectory /<br>
                NSItemReplacementDirectory /<br>
                mktemp(3)</a>
              </li>
              <li>
                <a href="/nsrange/">NSRange</a>
              </li>
              <li>
                <a href=
                "/nsnotification-and-nsnotificationcenter/">NSNotification
                &amp;<br>
                NSNotificationCenter</a>
              </li>
              <li>
                <a href="/nsfilemanager/">NSFileManager</a>
              </li>
              <li>
                <a href="/nsformatter/">NSFormatter</a>
              </li>
              <li>
                <a href="/nserror/">NSError</a>
              </li>
              <li>
                <a href="/key-value-observing/">Key-Value
                Observing</a>
              </li>
              <li>
                <a href="/nshashtable-and-nsmaptable/">NSHashTable
                &amp;<br>
                NSMapTable</a>
              </li>
              <li>
                <a href="/nspredicate/">NSPredicate</a>
              </li>
              <li>
                <a href="/nsexpression/">NSExpression</a>
              </li>
              <li>
                <a href="/enumerators/">NSFastEnumeration /<br>
                NSEnumerator /<br>
                -enumerateObjectsUsingBlock:</a>
              </li>
              <li>
                <a href="/uuid-udid-unique-identifier/">NSUUID
                /<br>
                CFUUIDRef /<br>
                UIDevice -uniqueIdentifier /<br>
                -identifierForVendor</a>
              </li>
              <li>
                <a href="/nsdatadetector/">NSDataDetector</a>
              </li>
              <li>
                <a href="/nscoding/">NSCoding / NSKeyedArchiver</a>
              </li>
              <li>
                <a href="/nssecurecoding/">NSSecureCoding</a>
              </li>
              <li>
                <a href=
                "/nsassertionhandler/">NSAssertionHandler</a>
              </li>
              <li>
                <a href="/nsurlcache/">NSURLCache</a>
              </li>
              <li>
                <a href="/nsvalue/">NSValue</a>
              </li>
              <li>
                <a href="/nslocalizedstring/">NSLocalizedString</a>
              </li>
              <li>
                <a href="/instancetype/">instancetype</a>
              </li>
              <li>
                <a href="/kvc-collection-operators/">KVC Collection
                Operators</a>
              </li>
              <li>
                <a href="/nsorderedset/">NSOrderedSet</a>
              </li>
              <li>
                <a href="/ns_enum-ns_options/">NS_ENUM &amp;
                NS_OPTIONS</a>
              </li>
              <li>
                <a href=
                "/nsvaluetransformer/">NSValueTransformer</a>
              </li>
              <li>
                <a href="/nsurlprotocol/">NSURLProtocol</a>
              </li>
              <li>
                <a href=
                "/nslinguistictagger/">NSLinguisticTagger</a>
              </li>
              <li>
                <a href="/nscharacterset/">NSCharacterSet</a>
              </li>
              <li>
                <a href="/nslocale/">NSLocale</a>
              </li>
              <li>
                <a href="/nsoperation/">NSOperation</a>
              </li>
              <li>
                <a href=
                "/nsincrementalstore/">NSIncrementalStore</a>
              </li>
              <li>
                <a href="/nsdatecomponents/">NSDateComponents</a>
              </li>
              <li>
                <a href="/nssortdescriptor/">NSSortDescriptor</a>
              </li>
              <li>
                <a href="/nscache/">NSCache</a>
              </li>
              <li>
                <a href="/nsindexset/">NSIndexSet</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              CoreFoundation
            </h2>
            <ul>
              <li>
                <a href="/cfbag/">CFBag</a>
              </li>
              <li>
                <a href="/cfstringtransform/">CFStringTransform</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              CoreGraphics
            </h2>
            <ul>
              <li>
                <a href="/cggeometry/">CGGeometry</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              UIKit
            </h2>
            <ul>
              <li>
                <a href=
                "/launch-options/">UIApplicationDelegate<br>
                launchOptions</a>
              </li>
              <li>
                <a href="/uimenucontroller/">UIMenuController</a>
              </li>
              <li>
                <a href="/uiappearance/">UIAppearance</a>
              </li>
              <li>
                <a href=
                "/uilocalizedindexedcollation/">UILocalizedIndexedCollation</a>
              </li>
              <li>
                <a href="/uicollectionview/">UICollectionView</a>
              </li>
              <li>
                <a href="/uiaccessibility/">UIAccessibility</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Objective-C
            </h2>
            <ul>
              <li>
                <a href="/namespacing/">Namespacing</a>
              </li>
              <li>
                <a href="/extended-file-attributes/">Extended File
                Attributes</a>
              </li>
              <li>
                <a href="/equality/">Equality</a>
              </li>
              <li>
                <a href="/random/">rand(3) / random(3) /
                arc4random(3) / et al.</a>
              </li>
              <li>
                <a href="/object-subscripting/">Object
                Subscripting</a>
              </li>
              <li>
                <a href="/bool/">BOOL / bool / Boolean /
                NSCFBoolean</a>
              </li>
              <li>
                <a href="/c-storage-classes/">C Storage Classes</a>
              </li>
              <li>
                <a href="/type-encodings/">Type Encodings</a>
              </li>
              <li>
                <a href="/__attribute__/">__attribute__</a>
              </li>
              <li>
                <a href="/nil/">nil / Nil / NULL / NSNull</a>
              </li>
              <li>
                <a href="/at-compiler-directives/">@</a>
              </li>
              <li>
                <a href="/pragma/">#pragma</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Open Source
            </h2>
            <ul>
              <li>
                <a href="/xctool/">xctool</a>
              </li>
              <li>
                <a href="/afnetworking-2/">AFNetworking 2.0</a>
              </li>
              <li>
                <a href="/core-data-libraries-and-utilities/">Core
                Data Libraries &amp; Utilities</a>
              </li>
              <li>
                <a href="/gpuimage/">GPUImage</a>
              </li>
              <li>
                <a href="/reactivecocoa/">ReactiveCocoa</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Testing
            </h2>
            <ul>
              <li>
                <a href="/unit-testing/">Unit Testing</a>
              </li>
            </ul>
          </div>
          <div>
            <h2>
              Miscellanea
            </h2>
            <ul>
              <li>
                <a href=
                "/avspeechsynthesizer/">AVSpeechSynthesizer</a>
              </li>
              <li>
                <a href="/empathy/">Empathy</a>
              </li>
              <li>
                <a href=
                "/dictionary-services/">UIReferenceLibraryViewController
                /<br>
                DCSDictionaryRef/<br>
                /usr/share/dict/words</a>
              </li>
              <li>
                <a href="/method-swizzling/">Method Swizzling</a>
              </li>
              <li>
                <a href="/associated-objects/">Associated
                Objects</a>
              </li>
              <li>
                <a href=
                "/mktileoverlay-mkmapsnapshotter-mkdirections/">MKTileOverlay,<br>
                MKMapSnapshotter &amp;<br>
                MKDirections</a>
              </li>
              <li>
                <a href="/stewardship/">Stewardship</a>
              </li>
              <li>
                <a href="/colophon/">Colophon</a>
              </li>
              <li>
                <a href="/new-years-2014/">Reader Submissions -<br>
                New Year's 2014</a>
              </li>
              <li>
                <a href="/multipeer-connectivity/">Multipeer
                Connectivity</a>
              </li>
              <li>
                <a href="/nshipster-quiz-4/">NSHipster Quiz #4</a>
              </li>
              <li>
                <a href=
                "/launch-arguments-and-environment-variables/">Launch
                Arguments &amp;<br>
                Environment Variables</a>
              </li>
              <li>
                <a href="/xcode-key-bindings-and-gestures/">Xcode
                Key Bindings &amp; Gestures</a>
              </li>
              <li>
                <a href="/ios7/">iOS 7</a>
              </li>
              <li>
                <a href="/network-link-conditioner/">Network Link
                Conditioner</a>
              </li>
              <li>
                <a href="/xcode-snippets/">Xcode Snippets</a>
              </li>
              <li>
                <a href="/documentation/">Documentation</a>
              </li>
              <li>
                <a href="/nshipster-quiz-3/">NSHipster Quiz #3</a>
              </li>
              <li>
                <a href="/nshipster-quiz-2/">NSHipster Quiz #2</a>
              </li>
              <li>
                <a href="/mklocalsearch/">MKLocalSearch</a>
              </li>
              <li>
                <a href="/nshipster-quiz-1/">NSHipster Quiz #1</a>
              </li>
              <li>
                <a href="/icloud/">iCloud</a>
              </li>
              <li>
                <a href="/search-kit/">Search Kit</a>
              </li>
              <li>
                <a href="/backrow/">Back Row</a>
              </li>
              <li>
                <a href=
                "/reader-submissions-new-years-2013/">Reader
                Submissions -<br>
                New Year's 2013</a>
              </li>
              <li>
                <a href="/addressbookui/">AddressBookUI</a>
              </li>
            </ul>
          </div>
        </section>
      </footer>
    </div><script type="text/javascript">
var Swiftype = window.Swiftype || {};
    (function() {
      Swiftype.key = 'Q5jNBiR8qVs5xE5dNect';
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.async = true;
      script.src = "//swiftype.com/embed.js";
      var entry = document.getElementsByTagName('script')[0];
      document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
    }());
    </script><script type="text/javascript">
var _gauges = _gauges || [];
    (function() {
      var t   = document.createElement('script');
      t.type  = 'text/javascript';
      t.async = true;
      t.id    = 'gauges-tracker';
      t.setAttribute('data-site-id', '510be6d4108d7b438800005f');
      t.src = '//secure.gaug.es/track.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(t, s);
    })();
    </script>
  </body>
</html>
